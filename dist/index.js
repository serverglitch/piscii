(()=>{var q=Object.create;var p=Object.defineProperty,B=Object.defineProperties,_=Object.getOwnPropertyDescriptor,k=Object.getOwnPropertyDescriptors,z=Object.getOwnPropertyNames,v=Object.getOwnPropertySymbols,N=Object.getPrototypeOf,S=Object.prototype.hasOwnProperty,F=Object.prototype.propertyIsEnumerable;var I=(e,f,t)=>f in e?p(e,f,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[f]=t,x=(e,f)=>{for(var t in f||(f={}))S.call(f,t)&&I(e,t,f[t]);if(v)for(var t of v(f))F.call(f,t)&&I(e,t,f[t]);return e},L=(e,f)=>B(e,k(f));var H=(e,f)=>()=>(f||e((f={exports:{}}).exports,f),f.exports);var U=(e,f,t,s)=>{if(f&&typeof f=="object"||typeof f=="function")for(let d of z(f))!S.call(e,d)&&d!==t&&p(e,d,{get:()=>f[d],enumerable:!(s=_(f,d))||s.enumerable});return e};var V=(e,f,t)=>(t=e!=null?q(N(e)):{},U(f||!e||!e.__esModule?p(t,"default",{value:e,enumerable:!0}):t,e));var E=H((D,b)=>{(function(e){function f(a,n){if(a=s(a),!a)return null;var o,u=1/0,r,l;n||(n=f.DEFAULT_COLORS);for(var g=0;g<n.length;++g)r=n[g].rgb,o=Math.pow(a.r-r.r,2)+Math.pow(a.g-r.g,2)+Math.pow(a.b-r.b,2),o<u&&(u=o,l=n[g]);return l.name?{name:l.name,value:l.source,rgb:l.rgb,distance:Math.sqrt(u)}:l.source}f.from=function a(n){var o=t(n),u=f,r=function(g){return u(g,o)};return r.from=a,r.or=function(g){var j=o.concat(t(g));return f.from(j)},r};function t(a){return a instanceof Array?a.map(function(n){return d(n)}):Object.keys(a).map(function(n){return d(a[n],n)})}function s(a){var n,o,u;if(typeof a=="object")return a;if(a in f.STANDARD_COLORS)return s(f.STANDARD_COLORS[a]);var r=a.match(/^#?((?:[0-9a-f]{3}){1,2})$/i);if(r)return r=r[1],r.length===3?r=[r.charAt(0)+r.charAt(0),r.charAt(1)+r.charAt(1),r.charAt(2)+r.charAt(2)]:r=[r.substring(0,2),r.substring(2,4),r.substring(4,6)],n=parseInt(r[0],16),o=parseInt(r[1],16),u=parseInt(r[2],16),{r:n,g:o,b:u};var l=a.match(/^rgb\(\s*(\d{1,3}%?),\s*(\d{1,3}%?),\s*(\d{1,3}%?)\s*\)$/i);if(l)return n=c(l[1]),o=c(l[2]),u=c(l[3]),{r:n,g:o,b:u};throw Error('"'+a+'" is not a valid color')}function d(a,n){var o={};if(n&&(o.name=n),typeof a=="string")o.source=a,o.rgb=s(a);else if(typeof a=="object"){if(a.source)return d(a.source,a.name);o.rgb=a,o.source=m(a)}return o}function c(a){return a.charAt(a.length-1)==="%"?Math.round(parseInt(a,10)*255/100):Number(a)}function m(a){return"#"+i(a.r.toString(16))+i(a.g.toString(16))+i(a.b.toString(16))}function i(a){return a.length===1&&(a="0"+a),a}f.STANDARD_COLORS={aqua:"#0ff",black:"#000",blue:"#00f",fuchsia:"#f0f",gray:"#808080",green:"#008000",lime:"#0f0",maroon:"#800000",navy:"#000080",olive:"#808000",orange:"#ffa500",purple:"#800080",red:"#f00",silver:"#c0c0c0",teal:"#008080",white:"#fff",yellow:"#ff0"},f.DEFAULT_COLORS=t(["#f00","#f80","#ff0","#0f0","#00f","#008","#808"]),f.VERSION="0.4.4",typeof b=="object"&&b&&b.exports?b.exports=f:e.nearestColor=f})(D)});var w={"016":"000000","017":"00005f","018":"000087","019":"0000af","020":"0000d7","021":"0000ff","022":"005f00","023":"005f5f","024":"005f87","025":"005faf","026":"005fd7","027":"005fff","028":"008700","029":"00875f","030":"008787","031":"0087af","032":"0087d7","033":"0087ff","034":"00af00","035":"00af5f","036":"00af87","037":"00afaf","038":"00afd7","039":"00afff","040":"00d700","041":"00d75f","042":"00d787","043":"00d7af","044":"00d7d7","045":"00d7ff","046":"00ff00","047":"00ff5f","048":"00ff87","049":"00ffaf","050":"00ffd7","051":"00ffff","052":"5f0000","053":"5f005f","054":"5f0087","055":"5f00af","056":"5f00d7","057":"5f00ff","058":"5f5f00","059":"5f5f5f","060":"5f5f87","061":"5f5faf","062":"5f5fd7","063":"5f5fff","064":"5f8700","065":"5f875f","066":"5f8787","067":"5f87af","068":"5f87d7","069":"5f87ff","070":"5faf00","071":"5faf5f","072":"5faf87","073":"5fafaf","074":"5fafd7","075":"5fafff","076":"5fd700","077":"5fd75f","078":"5fd787","079":"5fd7af","080":"5fd7d7","081":"5fd7ff","082":"5fff00","083":"5fff5f","084":"5fff87","085":"5fffaf","086":"5fffd7","087":"5fffff","088":"870000","089":"87005f","090":"870087","091":"8700af","092":"8700d7","093":"8700ff","094":"875f00","095":"875f5f","096":"875f87","097":"875faf","098":"875fd7","099":"875fff","100":"878700","101":"87875f","102":"878787","103":"8787af","104":"8787d7","105":"8787ff","106":"87af00","107":"87af5f","108":"87af87","109":"87afaf","110":"87afd7","111":"87afff","112":"87d700","113":"87d75f","114":"87d787","115":"87d7af","116":"87d7d7","117":"87d7ff","118":"87ff00","119":"87ff5f","120":"87ff87","121":"87ffaf","122":"87ffd7","123":"87ffff","124":"af0000","125":"af005f","126":"af0087","127":"af00af","128":"af00d7","129":"af00ff","130":"af5f00","131":"af5f5f","132":"af5f87","133":"af5faf","134":"af5fd7","135":"af5fff","136":"af8700","137":"af875f","138":"af8787","139":"af87af","140":"af87d7","141":"af87ff","142":"afaf00","143":"afaf5f","144":"afaf87","145":"afafaf","146":"afafd7","147":"afafff","148":"afd700","149":"afd75f","150":"afd787","151":"afd7af","152":"afd7d7","153":"afd7ff","154":"afff00","155":"afff5f","156":"afff87","157":"afffaf","158":"afffd7","159":"afffff","160":"d70000","161":"d7005f","162":"d70087","163":"d700af","164":"d700d7","165":"d700ff","166":"d75f00","167":"d75f5f","168":"d75f87","169":"d75faf","170":"d75fd7","171":"d75fff","172":"d78700","173":"d7875f","174":"d78787","175":"d787af","176":"d787d7","177":"d787ff","178":"d7af00","179":"d7af5f","180":"d7af87","181":"d7afaf","182":"d7afd7","183":"d7afff","184":"d7d700","185":"d7d75f","186":"d7d787","187":"d7d7af","188":"d7d7d7","189":"d7d7ff","190":"d7ff00","191":"d7ff5f","192":"d7ff87","193":"d7ffaf","194":"d7ffd7","195":"d7ffff","196":"ff0000","197":"ff005f","198":"ff0087","199":"ff00af","200":"ff00d7","201":"ff00ff","202":"ff5f00","203":"ff5f5f","204":"ff5f87","205":"ff5faf","206":"ff5fd7","207":"ff5fff","208":"ff8700","209":"ff875f","210":"ff8787","211":"ff87af","212":"ff87d7","213":"ff87ff","214":"ffaf00","215":"ffaf5f","216":"ffaf87","217":"ffafaf","218":"ffafd7","219":"ffafff","220":"ffd700","221":"ffd75f","222":"ffd787","223":"ffd7af","224":"ffd7d7","225":"ffd7ff","226":"ffff00","227":"ffff5f","228":"ffff87","229":"ffffaf","230":"ffffd7","231":"ffffff","232":"080808","233":"121212","234":"1c1c1c","235":"262626","236":"303030","237":"3a3a3a","238":"444444","239":"4e4e4e","240":"585858","241":"626262","242":"6c6c6c","243":"767676","244":"808080","245":"8a8a8a","246":"949494","247":"9e9e9e","248":"a8a8a8","249":"b2b2b2","250":"bcbcbc","251":"c6c6c6","252":"d0d0d0","253":"dadada","254":"e4e4e4","255":"eeeeee","16-a":"000000","231-z":"ffffff"},A={"016":"000","017":"001","018":"002","019":"003","020":"004","021":"005","022":"010","023":"011","024":"012","025":"013","026":"014","027":"015","028":"020","029":"021","030":"022","031":"023","032":"024","033":"025","034":"030","035":"031","036":"032","037":"033","038":"034","039":"035","040":"040","041":"041","042":"042","043":"043","044":"044","045":"045","046":"050","047":"051","048":"052","049":"053","050":"054","051":"055","052":"100","053":"101","054":"102","055":"103","056":"104","057":"105","058":"110","059":"111","060":"112","061":"113","062":"114","063":"115","064":"120","065":"121","066":"122","067":"123","068":"124","069":"125","070":"130","071":"131","072":"132","073":"133","074":"134","075":"135","076":"140","077":"141","078":"142","079":"143","080":"144","081":"145","082":"150","083":"151","084":"152","085":"153","086":"154","087":"155","088":"200","089":"201","090":"202","091":"203","092":"204","093":"205","094":"210","095":"211","096":"212","097":"213","098":"214","099":"215","100":"220","101":"221","102":"222","103":"223","104":"224","105":"225","106":"230","107":"231","108":"232","109":"233","110":"234","111":"235","112":"240","113":"241","114":"242","115":"243","116":"244","117":"245","118":"250","119":"251","120":"252","121":"253","122":"254","123":"255","124":"300","125":"301","126":"302","127":"303","128":"304","129":"305","130":"310","131":"311","132":"312","133":"313","134":"314","135":"315","136":"320","137":"321","138":"322","139":"323","140":"324","141":"325","142":"330","143":"331","144":"332","145":"333","146":"334","147":"335","148":"340","149":"341","150":"342","151":"343","152":"344","153":"345","154":"350","155":"351","156":"352","157":"353","158":"354","159":"355","160":"400","161":"401","162":"402","163":"403","164":"404","165":"405","166":"410","167":"411","168":"412","169":"413","170":"414","171":"415","172":"420","173":"421","174":"422","175":"423","176":"424","177":"425","178":"430","179":"431","180":"432","181":"433","182":"434","183":"435","184":"440","185":"441","186":"442","187":"443","188":"444","189":"445","190":"450","191":"451","192":"452","193":"453","194":"454","195":"455","196":"500","197":"501","198":"502","199":"503","200":"504","201":"505","202":"510","203":"511","204":"512","205":"513","206":"514","207":"515","208":"520","209":"521","210":"522","211":"523","212":"524","213":"525","214":"530","215":"531","216":"532","217":"533","218":"534","219":"535","220":"540","221":"541","222":"542","223":"543","224":"544","225":"545","226":"550","227":"551","228":"552","229":"553","230":"554","231":"555","232":"=b","233":"=c","234":"=d","235":"=e","236":"=f","237":"=g","238":"=h","239":"=i","240":"=j","241":"=k","242":"=l","243":"=m","244":"=n","245":"=o","246":"=p","247":"=q","248":"=r","249":"=s","250":"=t","251":"=u","252":"=v","253":"=w","254":"=x","255":"=y","16-a":"=a","231-z":"=z"};var M=V(E()),C=document.getElementById("preview"),G=document.getElementById("ascii"),W=document.getElementById("xterm"),R=C.getContext("2d"),T=document.querySelector('input[type="file"]'),Z=document.getElementById("scale"),h={width:100,height:100};var J=(e,f,t)=>.2126*e+.7152*f+.0722*t,K=()=>{let e=document.createElement("pre");e.style.display="inline",e.textContent=" ",document.body.appendChild(e);let{width:f,height:t}=e.getBoundingClientRect();return document.body.removeChild(e),t/f},P=(e,f)=>{let t=Math.floor(K()*e);return f>h.height?[Math.floor(t*h.height/f),h.height]:e>h.width?[h.width,Math.floor(f*h.width/t)]:[t,f]},Q=(e,f,t)=>{let s=e.getImageData(0,0,f,t),d=[],c=[],m=[];for(let i=0;i<s.data.length;i+=4){let a=s.data[i],n=s.data[i+1],o=s.data[i+2],u=s.data[i+3],r=J(a,n,o);s.data[i]=s.data[i+1]=s.data[i+2]=s.data[i+3]=r,d.push(r);let l=M.default.from(w)({r:a,g:n,b:o});m.push(L(x({},l.rgb),{a:u})),c.push(A[l.name])}return e.putImageData(s,0,0),{grayScales:d,pixelColors:m,xTermColors:c}},y=new FileReader,O=()=>{{let e=new Image;e.onload=()=>{let[f,t]=P(e.width,e.height);C.width=f,C.height=t,R.drawImage(e,0,0,f,t);let{grayScales:s,pixelColors:d,xTermColors:c}=Q(R,f,t);f0(s,d,c,f),T.value=""},e.src=y.result}};T.onchange=e=>{let f=e.target.files[0];y.onload=O,y.readAsDataURL(f)};var $=" ****########%%%%%%%%%%%@@@@@@@@@@@@@@@@",X=$.length,Y=e=>$[Math.ceil((X-1)*e/255)],f0=(e,f,t,s)=>{let d={lines:[],line:"",lastColor:null},c={lines:[],line:"",lastColor:null},m=1e4;e.forEach((i,a)=>{let n=Y(i),o=f[a],u=t[a];if(o.a!==0?(c.line+=c.lastColor===u?n:`|${u}${n}`,d.line+=d.lastColor===o?n:`${d.line!==""?"</span>":""}<span style="background-color:none;color:rgb(${o.r},${o.g},${o.b})">${n}`):(c.line+=" ",d.line+=" "),(a+1)%s===0){let r=d.line.search(/\S/);r<m&&r>-1&&(m=r),/^\s+$/.exec(d.line)===null&&(d.lines.push(d.line),c.lines.push(c.line)),c.line="",d.line=""}c.lastColor=o,d.lastColor=o}),W.innerText=c.lines.map((i,a)=>(a===0?"|000":"")+i.slice(m).trimEnd().replace(/[ ]/gm,"|_")).join("|/"),G.innerHTML=d.lines.map(i=>i.slice(m).trimEnd()).join("<br>")},a0=e=>{h.height=h.width=parseInt(e.target.value),O()};Z.addEventListener("change",a0);})();
